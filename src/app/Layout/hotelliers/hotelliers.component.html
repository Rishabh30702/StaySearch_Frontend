<div class="full-page-layout">
  <div class="container">
    <!-- Sidebar -->
    <div [class.collapsed]="isSidebarCollapsed" class="sidebar">
      <div class="logo-toggle">
        <span *ngIf="!isSidebarCollapsed" class="logo">StaySearch</span>
        <button (click)="toggleSidebar()" class="toggle-btn">
          <i class="fas fa-bars"></i>
        </button>
      </div>

      <ul class="menu">
        <li *ngFor="let item of menuItems" [class.active]="selectedMenu === item.key" (click)="selectMenu(item.key)">
          <i class="{{ item.icon }}"></i>
          <span *ngIf="!isSidebarCollapsed">{{ item.label }}</span>
        </li>
      </ul>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <div class="top-bar">
        <span>{{ todayDate }}</span>
        <div class="profile" (click)="toggleProfileDropdown()">
          <img src="https://i.pravatar.cc/40" alt="Profile" />
          <div *ngIf="showDropdown" class="dropdown">
            <button (click)="logout()">Logout</button>
          </div>
        </div>
      </div>

      <!-- Dashboard -->
      <div *ngIf="selectedMenu === 'dashboard'" class="fade-in">
        <div class="cards">
          <div class="card" *ngFor="let stat of overviewStats">
            <h3>{{ stat.label }}</h3>
            <p>{{ stat.value }}</p>
          </div>
        </div>
      </div>

      <!-- Rooms -->
      <div *ngIf="selectedMenu === 'rooms'" class="fade-in">
        <h2 class="section-title">Room Management</h2>

        <!-- Add Room Toggle -->
        <button (click)="showAddRoomForm = !showAddRoomForm" class="add-room-btn">
          {{ showAddRoomForm ? 'Cancel' : '‚ûï Add New Room' }}
        </button>

        <!-- Add Room Form -->
        <div *ngIf="showAddRoomForm" class="add-room-form">
          <h3>Add Room Details</h3>

          <input type="text" [(ngModel)]="newRoom.name" placeholder="Room Name (e.g. Executive Deluxe)" />
          <input type="number" [(ngModel)]="newRoom.total" placeholder="Total Rooms" min="1" />
          <input type="number" [(ngModel)]="newRoom.available" placeholder="Available Rooms" min="0" />
          <input type="number" [(ngModel)]="newRoom.price" placeholder="Price per Day (‚Çπ)" min="1" />
          <!-- For newRoom -->
          <label>Description</label>
          <textarea [(ngModel)]="newRoom.description" name="roomDesc"></textarea>



          <label class="deal-label">
            <input type="checkbox" [(ngModel)]="newRoom.deal" />
            Deal Available
          </label>

          <!-- Image Upload -->
          <input type="file" (change)="onFileSelected($event)" accept="image/*" />

          <button (click)="addRoom()" class="submit-btn">‚úÖ Add Room</button>
        </div>

        <!-- Room Cards -->
        <div class="rooms">
          <div class="room" *ngFor="let room of rooms; let i = index">
            <span *ngIf="room.deal" class="badge">DEAL</span>
            <img *ngIf="room.imageUrl" [src]="room.imageUrl" alt="Room Image" class="room-image" />

            <h4>{{ room.name }}</h4>
            <p><strong>Availability:</strong> {{ room.available }} / {{ room.total }}</p>
            <p class="price"><strong>‚Çπ{{ room.price }}</strong> /day</p>

            <!-- Description with toggle -->
            <div class="description-container" *ngIf="room.description">
              <p class="description-text" [ngClass]="{ 'clamped': !room.showFullDesc }">
                <strong>Description:</strong> {{ room.description }}
              </p>

              <button *ngIf="room.description && room.description.length > 150" (click)="toggleDescription(i)"
                class="toggle-btn">
                {{ room.showFullDesc ? 'Show Less ‚ñ≤' : 'Show More ‚ñº' }}
              </button>
            </div>

            <!-- Buttons -->
            <div class="room-actions">
              <button (click)="editRoom(i)" class="edit-btn">‚úèÔ∏è Edit</button>
              <button *ngIf="room.id !== undefined" (click)="deleteRoom(room.id!)" class="delete-btn">üóëÔ∏è
                Delete</button>
            </div>
          </div>
        </div>

        <!-- Room Status Summary -->
        <div class="status">
          <div class="card">
            <h3>Room Status</h3>
            <p><strong>Occupied:</strong> {{ roomStatus.occupied }}</p>
            <p><strong>Available:</strong> {{ roomStatus.available }}</p>
          </div>
        </div>
      </div>

      <!-- Deals -->
      <div *ngIf="selectedMenu === 'deal'" class="fade-in">
        <h2 class="section-title">Deals</h2>
        <!-- <button (click)="toggleDealForm()" class="create-deal-btn">+ Create New Deal</button> -->

        <div *ngIf="showDealForm" class="deal-form">
          <input [(ngModel)]="newDeal.name" placeholder="Room Name" />
          <input type="number" [(ngModel)]="newDeal.price" placeholder="Price" />
          <input type="number" [(ngModel)]="newDeal.total" placeholder="Total Rooms" />
          <input type="number" [(ngModel)]="newDeal.available" placeholder="Available Rooms" />

          <!-- For newDeal -->
          <label>Description</label>
          <textarea [(ngModel)]="newDeal.description" name="dealDesc"></textarea>
          <button (click)="createDeal()">Add Deal</button>
        </div>

        <!-- Deal Cards -->
         <div class="rooms">
             <div class="room" *ngFor="let room of filteredDeals; let i = index">
          <span class="badge">DEAL</span>
          <img *ngIf="room.imageUrl" [src]="room.imageUrl" alt="Room Image" class="room-image" />
 
         <h4>{{ room.name }}</h4>
         <p><strong>Availability:</strong> {{ room.available }} / {{ room.total }}</p>
          <p class="price"><strong>‚Çπ{{ room.price }}</strong> /day</p>

         <!-- Description with toggle -->
          <div class="description-container" *ngIf="room.description">
             <p class="description-text" [ngClass]="{ 'clamped': !room.showFullDesc }">
            <strong>Description:</strong> {{ room.description }}
            </p>

            <button *ngIf="room.description.length > 150" (click)="toggleDescription(i)"
            class="toggle-btn">
             {{ room.showFullDesc ? 'Show Less ‚ñ≤' : 'Show More ‚ñº' }}
          </button>
           </div>

          <!-- Buttons -->
         <div class="room-actions">
           <button (click)="editRoomById(room.id!)" class="edit-btn">‚úèÔ∏è Edit</button>
          <button (click)="deleteRoom(room.id!)" class="delete-btn">üóëÔ∏è Delete</button>
           </div>
         </div>
         </div>

          </div>

         <!-- Rates -->
          <div *ngIf="selectedMenu === 'rate'" class="fade-in">
            <h2 class="section-title">Rates</h2>
           <div class="rooms">
             <div class="room" *ngFor="let room of rooms; let i = index">
              <h4>{{ room.name }}</h4>

              <div *ngIf="editMode && selectedRoomIndex === i">
                <input type="number" [(ngModel)]="updatedPrice" min="0" placeholder="Enter new price" />
                <button (click)="saveRate(i)">Save</button>
                <button (click)="cancelEdit()">Cancel</button>
              </div>

               <div *ngIf="!(editMode && selectedRoomIndex === i)">
               <p>Current Price: ‚Çπ{{ room.price }}/day</p>
               <button (click)="enableEdit(i, room.price)">Edit</button>
             </div>
           </div>
         </div>
       </div>


    <!-- Feedbacks and reviews -->
    <div *ngIf="selectedMenu === 'feedbacks'" class="fade-in feedback-wrapper">
      <h2 class="section-title">üåü Feedback & Reviews</h2>
    
      <div class="feedbacks">
        <div class="feedback-card animate-card" *ngFor="let feedback of feedbacks">
          <div class="header">
            <h3>{{ feedback.hotelName }}</h3>
    
            
    
            <!-- ‚≠ê Star Rating -->
            <div class="rating">
              <ng-container *ngFor="let star of createStarArray(feedback.rating)">
                <i class="fas fa-star star-icon"></i>
              </ng-container>
            </div>
          </div>
    
          <!-- üìù Feedback Description -->
           <!-- üë§ User Info -->
           <div *ngIf="feedback.user">
            <i class="fa fa-user"></i> user: {{ feedback.user.fullname || feedback.user.username }}
          </div>
          <p class="description">"{{ feedback.description || 'No description provided.' }}"</p>
    
          <!-- ‚ù§Ô∏è Liked Amenities -->
          <div *ngIf="feedback.likedAmenities?.length">
            <p class="amenities-label">‚ù§Ô∏è Liked Amenities:</p>
            <div class="amenities">
              <span class="amenity-tag" *ngFor="let amenity of feedback.likedAmenities">
                {{ amenity }}
              </span>
            </div>
          </div>
    
          <!-- üïí Timestamp -->
          <p class="timestamp">üïí {{ feedback.createdAt | date: 'medium' }}</p>
    
          <!-- üóëÔ∏è Delete Button -->
          <button (click)="deleteFeedback(feedback.id)" class="btn btn-danger mt-2">
            <i class="fas fa-trash"></i> Delete
          </button>
        </div>
      </div>
    </div>
    
    <!-- ------------ -->
    <!-- Hotel registration -->
     <!-- ------------ -->
    <div *ngIf="selectedMenu === 'hotels'" class="fade-in">
      <div class="form-container">
        <h1>List a New Property</h1>
    
        <form id="property-form" action="/your-server-endpoint-here" method="POST" enctype="multipart/form-data">
    
          <!-- Property Identification -->
          <fieldset>
            <legend>Property Identification</legend>
            <div class="form-group">
              <label for="propertyName">Property Name:</label>
              <input type="text" id="propertyName" name="propertyName" required maxlength="100" placeholder="e.g., The Oberoi Amar Villas" />
              <div class="validation-note">Maximum 100 characters.</div>
            </div>
          </fieldset>
    
          <!-- Property Address & Location -->
          <fieldset>
            <legend>Property Address & Location</legend>
    
            <div class="form-group">
              <label for="propertyAddress">Full Street Address:</label>
              <input type="text" id="propertyAddress" name="propertyAddress" required placeholder="e.g., Taj East Gate Rd,Paktola,Agra" />
            </div>
    
            <div class="form-group">
              <label for="district">District:</label>
              <select id="district" name="district" required>
                <option value="" disabled selected>-- Select District --</option>
                <option value="district_1">Central District</option>
                <option value="district_2">Northern Heights</option>
                <option value="district_3">Riverside</option>
                <option value="district_4">West End</option>
              </select>
            </div>
    
            <div class="form-group">
              <label for="village">Village / Area:</label>
              <select id="village" name="village" required>
                <option value="" disabled selected>-- Select Village/Area --</option>
                <option value="village_a">Lucknow (Central)</option>
                <option value="village_b">Ayodhya (Northern)</option>
                <option value="village_c">Varanasi (Riverside)</option>
                <option value="village_d">Agra (Western)</option>
              </select>
            </div>
          </fieldset>
    
          <!-- Property Photos -->
          <fieldset>
            <legend>Property Photos</legend>
            <div class="form-group">
              <label for="propertyPhotos">Upload Photos:</label>
              <input type="file" id="propertyPhotos" name="propertyPhotos[]" multiple accept=".jpg, .jpeg, .png" />
              <div class="validation-note">Allowed formats: JPG or PNG</div>
              <div id="image-preview"></div>
            </div>
          </fieldset>
    
          <!-- Descriptions -->
          <fieldset>
            <legend>Descriptions</legend>
            <div class="form-group">
              <label for="shortDescription">Short Description:</label>
              <textarea id="shortDescription" name="shortDescription" rows="3" required maxlength="250"></textarea>
              <div class="validation-note">Max 250 characters.</div>
            </div>
    
            <div class="form-group">
              <label for="longDescription">Long Description:</label>
              <textarea id="longDescription" name="longDescription" rows="6" placeholder="Detailed description of the property..."></textarea>
              <div class="field-description">Provide full details.</div>
            </div>
          </fieldset>
    
          <!-- Amenities -->
          <fieldset>
            <legend>Amenities</legend>
            <div class="form-group amenities-group">
              <label>Check all available amenities:</label><br />
              <label><input type="checkbox" name="amenities[]" value="wifi" /> Wi-Fi</label>
              <label><input type="checkbox" name="amenities[]" value="pool" /> Pool</label>
              <label><input type="checkbox" name="amenities[]" value="gym" /> Gym</label>
              <label><input type="checkbox" name="amenities[]" value="parking" /> Parking</label>
              <label><input type="checkbox" name="amenities[]" value="ac" /> Air Conditioning</label>
              <label><input type="checkbox" name="amenities[]" value="heating" /> Heating</label>
              <label><input type="checkbox" name="amenities[]" value="laundry" /> Laundry (In-Unit)</label>
              <label><input type="checkbox" name="amenities[]" value="balcony" /> Balcony/Patio</label>
              <label><input type="checkbox" name="amenities[]" value="furnished" /> Furnished</label>
            </div>
            <div class="field-description">Select all features available at the property.</div>
          </fieldset>
    
          <!-- Contact Info -->
          <fieldset>
            <legend>Contact Information</legend>
    
            <!-- Phone Number -->
            <div class="form-group">
              <label for="phoneInput">Phone Number</label>
              <input
                type="tel"
                id="phoneInput"
                class="form-control"
                name="phone"
                [(ngModel)]="user.phone"
                #phoneInput="ngModel"
                required
                maxlength="10"
                pattern="^\d{10}$"
                placeholder="Enter 10-digit phone number"
              />
              <div *ngIf="phoneInput.invalid && (phoneInput.dirty || phoneInput.touched)" class="alert alert-danger error-message">
                <small *ngIf="phoneInput.errors?.['required']">Phone number is required!</small>
                <small *ngIf="phoneInput.errors?.['pattern']">Please enter a valid 10-digit phone number (digits only).</small>
                <small *ngIf="phoneInput.errors?.['maxlength']">
                  Phone number cannot exceed {{ phoneInput.errors?.['maxlength'].requiredLength }} digits.
                </small>
              </div>
            </div>
    
            <!-- Email -->
            <div class="form-group">
              <label for="emailInput">Email</label>
              <input
                type="email"
                id="emailInput"
                class="form-control"
                name="email"
                [(ngModel)]="user.email"
                #emailInput="ngModel"
                required
                email
                placeholder="Enter your email"
              />
              <div *ngIf="emailInput.invalid && (emailInput.dirty || emailInput.touched)" class="alert alert-danger error-message">
                <small *ngIf="emailInput.errors?.['required']">Email is required!</small>
                <small *ngIf="emailInput.errors?.['email']">Please enter a valid email address.</small>
              </div>
            </div>
          </fieldset>
    
        </form>
      </div>
    </div>
    
    

    




    


    <!-- =============================================== -->
    <!-- Edit Room Popup Form -->
    <!-- =============================================== -->
    <div *ngIf="editIndex !== null" class="edit-room-popup">
      <div class="edit-room-modal">
        <h3>Edit Room Details</h3>

        <input type="text" [(ngModel)]="newRoom.name" placeholder="Room Name" />
        <input type="number" [(ngModel)]="newRoom.total" placeholder="Total Rooms" />
        <input type="number" [(ngModel)]="newRoom.available" placeholder="Available Rooms" />
        <input type="number" [(ngModel)]="newRoom.price" placeholder="Price per Day" />

        <label>Description</label>
        <textarea [(ngModel)]="newRoom.description" placeholder="Description"></textarea>

        <label>Update Image</label>
        <input type="file" (change)="onFileSelected($event)" accept="image/*" />

        <img *ngIf="newRoom.imageUrl" [src]="newRoom.imageUrl" alt="Room Image" class="room-image-preview" />


        <label>
          <input type="checkbox" [(ngModel)]="newRoom.deal" />
          <span style="color: black;">Deal Available</span>
        </label>

        <div class="modal-buttons">
          <button (click)="updateRoom()">‚úÖ Update</button>
          <button (click)="cancelEditRoomPopup()">‚ùå Cancel</button>
        </div>
      </div>
    </div>


  </div>
</div>